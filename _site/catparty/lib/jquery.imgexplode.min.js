/*
 * jquery-image-explode 1.0.7
 * A jQuery explosion plugin.
 * https://github.com/blackmiaool/jquery-image-explode#readme
 *
 * Copyright 2015, blackmiaool
 * Released under the MIT license.
*/

"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){var a="explode-wrapper";t.fn.explodeRestore=function(){this.each(function(){var e=t(this),i=e.prop(a);i&&(i.replaceWith(e),e.prop(a,null))})},t.fn.explode=function(e){function i(t){function a(){var o=Date.now(),n=o-e;at.clearRect(0,0,B,J),V.forEach(function(t){at.save();var a=t.width,e=t.height;at.translate(t.biasx,t.biasy),at.rotate(t.lastAngle||t.finalAngleRad),k&&(at.beginPath(),at.arc(0,0,a/2,0,2*Math.PI,!1),at.closePath(),at.clip());var o=void 0;o=n<t.time1?1:n>t.time2?0:1-(n-t.time1)/M,0!==o||t.released||(t.released=!0,i--),at.globalAlpha=o,at.drawImage(tt[0],t.left,t.top,t.width,t.height,-a/2,-e/2,a,e),at.restore()}),i?window.requestAnimationFrame(a):t&&t()}var e=Date.now(),i=V.length;V.forEach(function(t){t.time1=1e3/(t.ratio*(L+1-t.width)/L+.1),t.time2=t.time1+M}),a()}function o(){setTimeout(function(){n(function(){N.explodeRestore()},!0)},R)}function n(t,a){function e(){var r=Date.now(),h=void 0,l=void 0;if(h=(r-o)/1e3,l=(r-i)/q,a&&(l=1-l),W)rt+=W*h*300;else{if(l>1||l<0)return void(t&&t());h*=Math.cos(l*Math.PI/2)*Math.PI/2}a&&(h=-h),o=r,at.clearRect(0,0,B,J),V.forEach(function(t){at.save();var a=t.width,e=t.height;t.land||(t.biasx+=t.vx*h,t.biasy+=(t.vy+rt)*h,W&&t.biasy>t.transYMax&&(n--,t.land=!0,t.lastAngle=t.finalAngleRad*l,t.biasy=t.transYMax)),at.translate(t.biasx,t.biasy),t.lastAngle?at.rotate(t.lastAngle):at.rotate(t.finalAngleRad*l),k&&(at.beginPath(),at.arc(0,0,a/2,0,2*Math.PI,!1),at.closePath(),at.clip()),at.drawImage(tt[0],t.left,t.top,t.width,t.height,-a/2,-e/2,a,e),at.restore()}),W&&!n?t():window.requestAnimationFrame(e)}var i=Date.now(),o=i,n=V.length;a||V.forEach(function(t){t.vx=t.translateX/q*1e3,t.vy=t.translateY/q*1e3,t.biasx=t.translateX0,t.biasy=t.translateY0,t.transYMax=J/2+F-t.height/2}),e()}function r(t,a){return parseInt(Math.random()*(a+1-t),10)+t}function h(){V.forEach(function(t,a){var e=(Math.random()*C*2-C)/((Math.random()+2)*t.width)*10,i=t.left+t.width/2-_/2,o=t.top+t.width/2-H/2;0===i&&(i=a%2?-1:1),0===o&&(o=a%4<2?-1:1);var n=Math.sqrt(i*i+o*o),r=((1-U)*(1-(t.width-f)/(L-f))+U)*Math.random();r=1-(1-r)*(1-w/g);var h=(g-n)*r+n,l=n*n,d={finalDistance:h,ratio:r,x:i,y:o,distance:n,translateX:(h-n)*Math.sqrt((l-o*o)/l)*(i>0?1:-1),translateY:(h-n)*Math.sqrt((l-i*i)/l)*(o>0?1:-1),translateX0:(B-_)/2+t.left+t.width/2,translateY0:(J-H)/2+t.top+t.height/2,finalAngle:e,finalAngleRad:e*(Math.PI/180)};for(var s in d)t[s]=d[s]})}function l(){function t(t,a){return!(t<z[0]&&a>H-z[0]||t>_-z[1]&&a>H-z[1]||t>_-z[2]&&a<z[2]||t<z[3]&&a<z[3])}function a(t,a,e,i,o){return(t-e)*(t-e)+(a-i)*(a-i)<o*o}function e(e){var i=e.left,o=e.top,r=e.width,l=e.height,s=i+r/2,c=H-o-l/2;(d||t(s,c)||z.some(function(t,e){return a(s,c,n[e][0]*_+2*(.5-n[e][0])*t,n[e][1]*H+2*(.5-n[e][1])*t,t)}))&&h.push({left:i,top:o,width:r,height:l})}function i(t){function a(t){var a=i;if(i+=t,e({left:a,top:o,width:t,height:t}),E)for(var n=1;n<parseInt(L/t);n++)e({left:a,top:o+n*t,width:t,height:t})}var i=0,o=t*L,n=void 0;do n&&a(n),n=r(f,L);while(_>i+n);_-i>=f&&a(_-i)}var o=void 0,n=[[0,1],[1,1],[1,0],[0,0]];o=v?Math.floor(H/L):Math.ceil(H/L);for(var h=[],l=0;l<o;l++)i(l);var d=z.every(function(t){return 0===t});return h.sort(function(t,a){return Math.random()>.5?1:-1}),h}function d(){var t=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"],a=N.width();return t=t.map(function(t){var e=N.css(t);return e.match(/px$/)?1*e.match(/^\d+/)[0]:e.match(/%$/)?e.match(/^\d+/)[0]/100*a:e}),t=t.map(function(t){return t>a/2&&(t=a/2),t})}e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))||(e={});var s=e,c=s.minWidth,f=void 0===c?3:c,u=s.omitLastLine,v=void 0!==u&&u,p=s.radius,g=void 0===p?80:p,m=s.minRadius,w=void 0===m?0:m,b=s.release,y=void 0===b||b,x=s.fadeTime,M=void 0===x?300:x,A=s.recycle,I=void 0===A||A,P=s.recycleDelay,R=void 0===P?500:P,D=s.fill,E=void 0===D||D,Y=s.explodeTime,q=void 0===Y?300:Y,S=s.maxAngle,C=void 0===S?360:S,T=s.gravity,W=void 0===T?0:T,X=s.round,k=void 0!==X&&X,j=s.groundDistance,F=void 0===j?400:j,G=e,L=G.maxWidth,N=this,$=arguments;if(N.length>1)return void N.each(function(){var a=t(this);a.explode.apply(a,$)});if("IMG"===N.prop("tagName")&&!N.prop("complete"))return void N.on("load",function(){N.explode.apply(N,$)});var _=N.width(),H=N.height(),Q=Math.min(_,H),z=d(),B=Math.max(_,2*g),J=Math.max(H,2*g,2*F);L||(L=Q/4);var K=t("<div></div>",{class:a}),O=["width","height","margin-top","margin-right","margin-bottom","margin-left","position","top","right","bottom","left","float","display"];O.forEach(function(t){K.css(t,N.css(t))}),"static"===K.css("position")&&K.css("position","relative");var U=.3,V=l();h();var Z=t("<canvas></canvas>"),tt=t("<canvas></canvas>");Z.css({position:"absolute",left:(_-B)/2,right:(_-B)/2,top:(H-J)/2,bottom:(H-J)/2,margin:"auto",width:B,height:J}),tt.css({width:_,height:H}),tt.attr({width:_,height:H}),Z.attr({width:B,height:J}),K.append(Z);var at=Z[0].getContext("2d"),et=tt[0].getContext("2d"),it=N[0],ot=it.naturalWidth,nt=it.naturalHeight;"IMG"===N.prop("tagName")?et.drawImage(N[0],0,0,ot,nt,0,0,_,H):"none"!==N.css("backgroundImage")||("rgba(0, 0, 0, 0)"!==N.css("backgroundColor")?(et.fillStyle=N.css("backgroundColor"),et.fillRect(0,0,_,H)):console.warn("There's nothing to explode."));V.forEach(function(t){var a=t.left,e=t.top,i=t.width,o=t.height;t.naturalParams=[a,e,i,o]}),N.after(K),N.prop(a,K),N.detach();var rt=0;n(function(){y?i():I&&o()})}}(window.jQuery);